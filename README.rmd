---
title: "Thread Analisys"
author: "J.P.G."
date: "Summer 2018"
output:
  html_document:
    toc: yes
  html_notebook:
    highlight: pygments
    number_sections: yes
    theme: spacelab
    toc: yes
    toc_float: no
---

```{r}
library(DataDrivenSecFirehol)
```


Threat intel based on firehol's IP lists
=============================

Descargamos y descomprimimos los datos de Firehol, este proceso puede tardar un poco.
```{r}
path.raw.data <- DataDrivenSecFirehol::downloadFireHolData()
path.raw.data <- paste(path.raw.data, "blocklist-ipsets-master", sep="\\")
path.raw.data <- paste(path.raw.data, "\\", sep="")
```
El contenido está en `r path.raw.data`. Es un fichero temporal que se eliminará cuando cierres la sesión.

A continuación, vamos a proceder a parsear los datos anteriores y a generar el data frame ordenado. 

```{r}
df <- DataDrivenSecFirehol::tidyDataIPs(raw.path = path.raw.data)
```

Ya tenemos las IPs parseadas, ahora es el turno de la localización por IPs usando la base de datos de maxmind. Primero, debes eliminar los ficheros de IPs de continentes para no tener duplicados y obtener solo la de los países.
TODO: eliminar esos ficheros al descargarlos

```{r}
df2 <- DataDrivenSecFirehol::tidyDataCountries(raw.path = path.raw.data)
```

Una vez tenemos los dos data frames construidos y a punto, procedemos a fusionarlos para tener todo el contenido en un mismo dataframe.

```{r}
df_final <- DataDrivenSecFirehol::mergeDFs2(df,df2)
```

Ahora, os aconsejo probar algunos ejemplos como los de continuación:

JEFFREY COMPLETA PLIS...
